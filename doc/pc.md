# PC 端产品方案

## 一、产品定位

PC 端定位为**高效工作助手**，核心围绕"笔记记录 + 待办管理 + 实用工具"三大模块，配合 AI 能力提升用户的写作效率与内容质量。目标用户为有文档记录、任务管理需求的知识工作者。

---

## 二、用户体系

### 2.1 登录注册

- **邮箱注册**：用户通过邮箱 + 验证码完成注册
- **邮箱登录**：支持邮箱 + 密码登录，以及邮箱 + 验证码登录
- **忘记密码**：通过邮箱验证码重置密码
- **个人信息**：支持设置头像、昵称等基本资料

### 2.2 数据同步

- 登录后自动同步云端数据
- 支持多设备间笔记与待办的实时同步

---

## 三、核心功能

### 3.1 笔记模块（参考思源笔记 / 印象笔记）

#### 3.1.1 笔记组织

| 功能 | 说明 |
|------|------|
| 笔记本 | 支持创建多个笔记本，作为笔记的顶层分类容器 |
| 文件夹 | 笔记本内支持多级文件夹，实现层级化管理 |
| 标签系统 | 支持为笔记添加多个标签，便于跨笔记本检索 |
| 收藏 | 支持收藏常用笔记，快速访问 |
| 回收站 | 删除的笔记进入回收站，支持恢复或彻底删除 |

#### 3.1.2 编辑器功能

- **Markdown 支持**：
  - 完整支持标准 Markdown 语法（标题、列表、引用、代码块、表格等）
  - 支持所见即所得（WYSIWYG）模式与源码模式切换
  - 支持快捷键输入（如 `Ctrl+B` 加粗、`Ctrl+I` 斜体等）
- **富文本能力**：
  - 插入图片（支持拖拽、粘贴、本地上传）
  - 插入附件（PDF、文档等文件）
  - 插入链接与书签
  - 代码块支持语法高亮
  - 支持数学公式（LaTeX）
- **高级编辑**：
  - 双向链接：`[[]]` 语法快速关联其他笔记
  - 块引用：引用其他笔记中的特定内容块
  - 大纲视图：自动根据标题层级生成文档大纲
  - 全文搜索：支持对所有笔记内容进行关键词搜索

#### 3.1.3 导入导出

- 导入：支持 Markdown（.md）、Word（.docx）、HTML 格式导入
- 导出：支持导出为 Markdown、PDF、Word、HTML 格式

### 3.2 待办事项模块

#### 3.2.1 任务管理

| 功能 | 说明 |
|------|------|
| 创建待办 | 快速创建待办事项，支持设置标题与详细描述 |
| 优先级 | 支持设置优先级：紧急、高、中、低 |
| 截止时间 | 为待办设置截止日期与提醒时间 |
| 分类标签 | 为待办添加分类标签（工作、学习、生活等） |
| 子任务 | 支持将大任务拆分为多个子任务 |
| 状态流转 | 待办、进行中、已完成、已取消 |

#### 3.2.2 视图模式

- **列表视图**：按时间/优先级排序展示所有待办
- **看板视图**：按状态分栏展示（类似 Trello/看板）
- **日历视图**：在日历上直观查看各日期的待办安排
- **今日聚焦**：只展示今日到期及进行中的任务


### 3.3 实用工具模块

#### 3.3.1 图片处理

| 工具 | 说明 |
|------|------|
| 图片压缩 | 支持批量压缩图片，可选压缩质量等级 |
| 图片拼接 | 支持横向/纵向拼接多张图片 |
| 格式转换 | 支持 PNG、JPG、WebP、BMP 等格式互转 |
| 图片裁剪 | 支持自由裁剪与按比例裁剪 |
| AI 图片处理 | 图片去背景、图片增强、智能修复等 |

#### 3.3.2 文件压缩

| 工具 | 说明 |
|------|------|
| 压缩文件 | 支持将文件/文件夹压缩为 ZIP、7Z 格式 |
| 解压文件 | 支持解压 ZIP、RAR、7Z、TAR.GZ 等常见格式 |
| 批量操作 | 支持批量压缩/解压多个文件 |

#### 3.3.3 PDF 处理

| 工具 | 说明 |
|------|------|
| PDF 合并 | 将多个 PDF 文件合并为一个 |
| PDF 拆分 | 将一个 PDF 按页码拆分为多个文件 |
| PDF 转图片 | 将 PDF 页面导出为图片 |
| 图片转 PDF | 将多张图片合并生成 PDF |
| PDF 压缩 | 压缩 PDF 文件大小 |
| PDF 加水印 | 为 PDF 添加文字/图片水印 |

---

## 四、AI 能力

### 4.1 写作辅助

- **内容润色**：优化文字表达，使语句更通顺、更专业
- **语法纠错**：自动检测并修正拼写、语法错误
- **风格转换**：在正式/口语/学术等不同写作风格间转换
- **内容续写**：根据上下文自动生成后续内容

### 4.2 格式优化

- **自动排版**：一键优化笔记的格式与排版
- **Markdown 生成**：将普通文本自动转换为结构化的 Markdown 格式
- **摘要生成**：为长文自动生成摘要

### 4.3 智能助手

- **AI 对话**：在笔记中随时唤起 AI 对话，进行问答、头脑风暴
- **待办建议**：根据笔记内容智能提取可能的待办事项
- **智能搜索**：支持自然语言搜索笔记内容（语义搜索）

---

## 五、界面布局设计

### 5.1 整体布局（三栏式）

```
┌──────────────────────────────────────────────────────┐
│  顶部栏：搜索 | 同步状态 | AI助手 | 用户头像        │
├────────┬───────────┬─────────────────────────────────┤
│        │           │                                 │
│ 侧边栏  │  列表区    │         内容编辑区              │
│        │           │                                 │
│ · 笔记  │ 笔记/待办  │   Markdown 编辑器              │
│ · 待办  │ 列表展示   │   或工具操作界面                │
│ · 工具  │           │                                 │
│ · 设置  │           │                                 │
│        │           │                                 │
├────────┴───────────┴─────────────────────────────────┤
│  状态栏：字数统计 | 保存状态 | 快捷操作               │
└──────────────────────────────────────────────────────┘
```

### 5.2 设计风格

- 采用简洁现代的 UI 风格，以白色/浅灰为主色调
- 支持亮色模式与暗色模式切换
- 侧边栏支持折叠，最大化编辑区域
- 响应式布局，适配不同分辨率

---

## 六、整体架构与技术选型

### 6.1 通信架构

客户端采用 **「前端 ↔ Go 本地后端」** 的架构，所有与外部服务的交互统一由 Go 程序处理：

```
┌─────────────────┐         ┌─────────────────┐         ┌─────────────────┐
│     前端 UI      │  HTTP   │  Go 本地后端     │  HTTP   │   远程服务端     │
│  (Electron 等)   │ ◄─────► │  (客户端进程)    │ ◄─────► │  (登录/同步/AI)  │
└─────────────────┘         └─────────────────┘         └─────────────────┘
                                      │
                                      ▼
                             ┌─────────────────┐
                             │  本地 SQLite    │
                             │  笔记/待办存储   │
                             └─────────────────┘
```

- **前端**：只与本地 Go 程序通信（如调用 `http://localhost:端口/api/...`），不直接请求远程服务端。
- **Go 本地后端**：提供本地 API，负责笔记/待办读写、工具类操作（图片、PDF、压缩等）、以及需要时的**代理请求**（登录、云端同步、AI 等由 Go 向服务端发起请求，再将结果返回前端）。

这样便于统一鉴权、加密、日志与错误处理，并避免在前端暴露服务端地址与密钥。

### 6.2 技术选型建议

| 层级 | 技术方案 | 说明 |
|------|---------|------|
| 桌面框架 | electron-egg | 承载前端页面与窗口 |
| **客户端本地后端** | **Go** | 本地 API 服务、本地存储访问、转发请求服务端 |
| 前端框架 | Vue 3 / React | 配合 TypeScript 使用 |
| 编辑器 | Tiptap / Milkdown / Vditor | 基于 ProseMirror 的富文本编辑器，支持 Markdown |
| 状态管理 | Pinia / Zustand | 根据前端框架选择 |
| 本地存储 | SQLite | 由 Go 读写，笔记/待办本地存储与离线支持 |
| 云端同步 | 由 Go 请求服务端 | REST/WebSocket 由 Go 与远程服务通信，前端仅调 Go 接口 |
| AI 接口 | 由 Go 请求服务端 | OpenAI API/自建模型等由 Go 调用，前端只请求 Go 提供的 AI 接口 |

### 6.3 前端编辑方案选型与开源参考

#### 6.3.1 可选方案对比

| 方案 | 技术栈 | 特点 | 适用场景 |
|------|--------|------|----------|
| **Tiptap** | 基于 ProseMirror，Vue/React 组件 | 模块化、扩展丰富、社区活跃；需自行维护 Markdown ↔ 文档模型转换 | 需要强定制、多扩展的 WYSIWYG |
| **Milkdown** | 基于 ProseMirror，Markdown 优先 | 原生 Markdown 编辑与渲染，插件体系清晰 | 以 Markdown 为单一数据源的笔记 |
| **Vditor** | 自研编辑器 | 三模式（所见即所得/即时渲染/分屏）、开箱中文友好、体积较大 | 快速落地、对 Markdown 三模式有需求 |
| **思源/Lute** | 思源内核 Go + [Lute](https://github.com/88250/lute) 引擎 | 块级编辑、双向链接、与 Go 内核同栈；需对接思源数据格式或仅借鉴解析层 | 深度借鉴思源交互与块模型时 |

建议在 **Milkdown** 或 **Vditor** 中选型；若后续做块级引用、双向链接，可参考思源的块模型与数据结构。

#### 6.3.2 思源开源方案借鉴（[siyuan-note/siyuan](https://github.com/siyuan-note/siyuan)）

思源为「TypeScript 前端 + Go 内核」的隐私优先知识管理软件，与当前架构一致，可借鉴：

- **Lute 引擎**：[88250/lute](https://github.com/88250/lute) 为 Go 实现的 Markdown 解析/渲染引擎，可在 Go 端做 Markdown 转 HTML、摘要提取、搜索高亮，与前端渲染结果保持一致。
- **块级（Block）模型**：以块为最小单位存储，支持块级引用与双向链接；后续做块引用时可参考思源 `*.sy` 的 JSON 结构与块 ID 设计。
- **内核与前端通信**：通过本地 HTTP API（Go 提供）与前端通信，可参考其 [API 文档](https://github.com/siyuan-note/siyuan/blob/master/API.md)。

注意：思源整体为 AGPL-3.0，直接复用其前端或内核代码需遵守许可；仅借鉴架构思路或使用独立开源的 Lute 引擎则不强制传染。

#### 6.3.3 CommonMark 规范与一致性（[commonmark/commonmark-spec](https://github.com/commonmark/commonmark-spec)）

[CommonMark](https://commonmark.org) 是 Markdown 的标准化规范，对原始语法中未定义部分做了明确约定：

- **规范范围**：段落、标题、列表、引用、围栏代码块、强调、链接、图片等；规范源文件为 [spec.txt](https://github.com/commonmark/commonmark-spec/blob/master/spec.txt)。
- **一致性测试**：仓库内嵌 500+ 规范测试用例，可用 [spec_tests.py](https://github.com/commonmark/commonmark-spec#running-tests-against-the-spec) 或 [commonmark-spec npm 包](https://www.npmjs.com/package/commonmark-spec) 对「Markdown → 输出」做回归测试。
- **建议**：存储与交换格式统一为 **CommonMark 子集**；编辑器选型优先考虑支持 CommonMark 的实现；Go 端解析（如有）建议与 CommonMark 行为对齐（可参考 [commonmark.js](https://github.com/commonmark/commonmark.js) 或 Lute）。

---

## 七、版本规划

### v1.0 — MVP 版本

**目标**：完成核心功能闭环，可供内测使用

- [x] 邮箱注册/登录
- [ ] 笔记本与文件夹管理
- [ ] Markdown 编辑器（所见即所得）
- [ ] 基础待办事项（创建、完成、删除）
- [ ] 图片压缩工具


### v1.1 — 体验优化

- [ ] 标签系统
- [ ] 待办事项看板视图与日历视图
- [ ] 文件压缩/解压工具
- [ ] AI 写作润色功能
- [ ] 暗色模式
- [ ] PDF 合并/拆分工具

### v1.2 — AI 增强

- [ ] AI 对话助手
- [ ] 智能格式优化
- [ ] 智能待办提取
- [ ] 笔记双向链接
- [ ] 数据导入/导出

### v2.0 — 生态完善

- [ ] 多设备数据同步
- [ ] AI 图片处理（去背景、增强）
- [ ] 插件系统（可扩展能力）
- [ ] 协作功能（共享笔记本）

---

## 八、关键指标

| 指标 | 目标 |
|------|------|
| 应用启动时间 | < 3 秒 |
| 编辑器响应延迟 | < 100ms |
| 本地笔记搜索速度 | < 500ms（万级笔记） |
| 安装包大小 | < 100MB（Tauri）/ < 200MB（Electron） |
| AI 响应时间 | < 5 秒（润色/纠错类） |
